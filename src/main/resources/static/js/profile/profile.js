let imgFile,currentAccount,web3;function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){document.getElementById("imgPreview").src=e.target.result},t.readAsDataURL(e.files[0]),imgFile=e.files[0]}else document.getElementById("preview").src=""}function settingConfirm(){const e=document.getElementById("nickname").value;if(""===e|!e)return notification("별명을 입력해주세요."),!1;if(/[\{\}\[\]\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/g.test(e))return notification("특수문자는 입력하실수 없습니다."),!1;if(e.length<2||e.length>10)return notification("2~10글자 사이로 입력해주세요."),!1;let t=new FormData;void 0===imgFile||null==imgFile||""==imgFile?t.append("image",null):t.append("image",imgFile),$.ajax({type:"POST",enctype:"multipart/form-data",url:"/profile/"+e,data:t,mimeType:"multipart/form-data",processData:!1,contentType:!1,cache:!1,timeout:6e5,success:function(e){window.location.href="/board/list"},error:function(e){notification("이미 존재하는 별명입니다.")}})}async function deleteUser(){(await confirm("","정말로 탈퇴 하시겠습니까?")).isConfirmed&&$.ajax({url:"/profile/delete",type:"DELETE",success:function(e){window.location.href="/logout"},error:function(e){notification("탈퇴에 실패했습니다. 다시 시도해주세요.")}})}function notification(e){return Swal.mixin({toast:!0,position:"top-end",showCloseButton:!0,showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:"warning",background:"#e76876",title:'<h4 style="color: white;">'+e+"</h4>"}),!1}function confirm(e,t){return new Promise((function(n,o){Swal.fire({title:t,text:e,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"확인",cancelButtonText:"취소"}).then((e=>{n(e)}))}))}window.addEventListener("load",(async()=>{if(window.ethereum?(web3=new Web3(window.ethereum),await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x5"}]})):void 0!==window.web3?web3=new Web3(window.web3.currentProvider):reject(new Error("web3 인스턴스가 주입되지 않았습니다.")),web3&&(currentAccount=await web3.eth.requestAccounts()),document.getElementById("wallet"))try{currentAccount=web3.eth.requestAccounts().then((function(e){document.getElementById("wallet").textContent=e[0],document.getElementById("wallet").style.color="#6f42c1c7"})),window.ethereum.on("accountsChanged",(async function(){accounts=await web3.eth.getAccounts(),document.getElementById("wallet").textContent=accounts[0],document.getElementById("wallet").style.color="#6f42c1c7"}))}catch(e){document.getElementById("wallet").textContent="MetaMask 연동되지 않은 상태입니다.",document.getElementById("wallet").style.color="#e76876"}})),document.getElementById("ConnectMetaMask").addEventListener("click",(async()=>{await ethereum.request({method:"eth_requestAccounts"}),await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x5"}]})}));